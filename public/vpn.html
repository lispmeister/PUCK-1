<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>PUCKasaurus Rex!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="rawr!">

    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }

      .ip_address {
         /* border-style: solid ; 
         border-color: black; 
         border-width: 2px; */
         color: gray:
      }

   div.growlUI { background: url(check48.png) no-repeat 10px 10px }
   div.growlUI h1, div.growlUI h2 {
      color: white; padding: 5px 5px 5px 75px; text-align: left
   }

    <!-- webrtc vid stuff -->

<!--
    #remoteVideos video { height: 300px; }
    #localVideo         { height: 300px; }
-->

    <!-- borders -->

    .dropshadowclass { 
        border: solid 1px #CCC;
         -moz-box-shadow: 5px 5px 0px #999;
         -webkit-box-shadow: 5px 5px 0px #999;
         box-shadow: 5px 5px 0px #999;
     }


    /* logs */

    .output{margin:20px 40px;}

    .output a{display:inline-block; text-decoration:none; padding:3px 15px; -webkit-border-radius:15px; -moz-border-radius:15px; border-radius:15px; background:#000; margin:5px 20px 5px 0;}

    .content { margin:40px; width:1000px; height:500px; padding:20px; overflow:auto; background:#ddd; -webkit-border-radius:3px; -moz-border-radius:3px; border-radius:3px;}

    </style>
    <!-- <link href="/css/bootstrap-responsive.css" rel="stylesheet"> -->

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

   <!-- for pucks -->
   <!-- http://cube3x.com/adipoli-jquery-image-hover-plugin/ -->
   <link href="/css/adipoli.css" rel="stylesheet" type="text/css"/>

</head>


<body>

    <div class="container">

      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li> <button class="btn btn-danger disabled nounderline" id="puck_video" type="button"><a style="text-decoration: none" href="/vpn.html"><span style="color: #fff !important;" class="glyphicon glyphicon-facetime-video"></span> <span style="color: #fff !important;">Video</span></a></button>
          <li class="muted"><a href="https://github.com/the-puck">Github</a></li>
          <li class="muted"><a href="/logs.html">Logs</a></li>
          <li class="muted"><a href="#">Help</a></li>
        </ul>
          <h3 class="active"><a href="/puck.html">PUCK!</a></h3>
      </div>

      <hr>

      <div class="hero-unit">
          <p>If you don't see video... something is wrong!</P>
      </div>

    </div>

    <div class="container">


        <div> <a href="#" id="outgoing" class="button left"></a></div>

        <video id="localVideo"></video>

        <div><button data-loading-text="hanging up..." class="btn btn-warning nounderline" id="puck_disconnect" type="button"><span style="color: #fff !important;" class="glyphicon glyphicon-facetime-video"></span> <span style="color: #fff !important;">Disconnect</span></a></button></div>

        <div id="remoteVideos"></div>

        <div id="incoming"></div>

    </div>

    <div id="ovpn_client_infinity" class="content">
        <p>VPN client logs <hr/></p>
    </div>

    <hr />

    <!-- content block -->
    <div id="ovpn_server_infinity" class="content">
        <p>VPN server logs <hr/></p>
    </div>


    <!-- spacer n feets below -->

    <div class="btn-toolbar"> <span></span></div>
    <div class="btn-toolbar"> <span class="spacer100"></span></div>

    <div class="footer" id="puck_footy">
        <p id='ip_diddy' class="text-muted credit">no electrons were harmed in the making of this footer</p>
    </div>


<!-- le javascript -->
<script type="text/javascript" src="/js/jquery-2.1.0.min.js"></script>

<script type="text/javascript" src="/js/socket.io.js"></script>
<script type="text/javascript" src="/js/simplewebrtc.js"></script>

<script type="text/javascript" src='/js/bootstrap.js'></script>
<script type="text/javascript" src='/js/moustache.js'></script>
<script type="text/javascript" src='/js/jquery.adipoli.min.js'></script>
<script type="text/javascript" src='/js/jquery.json-2.4.min.js'></script>
<script type="text/javascript" src='/js/jquery.inputmask.js'></script>
<script type="text/javascript" src="/js/underscore-min.js"></script>

<script type="text/javascript" src='/js/spin.js'></script>
<script type="text/javascript" src='/js/jquery.blockUI.js'></script>
<script type="text/javascript" src='/js/jquery.avgrund.js'></script>
<script type="text/javascript" src="/js/jquery.bootstrap-growl.min.js"></script>
<script type="text/javascript" src="/js/bootstrap-paginator.js"></script>

<script type="text/javascript" src='/js/puck.js'></script>

<script type='text/javascript'>

$(document).ready(function () {

    var browser_ip = ""

    get_ip('#ip_diddy')

    $("#ovpn_client_infinity").mCustomScrollbar({ scrollButtons:{ enable:true } });
    $("#ovpn_server_infinity").mCustomScrollbar({ scrollButtons:{ enable:true } });

    // var socket = io.connect(':8080/');
    // var socket = io.connect('https://10.93.54.6:8080/');

    var local_socket = io.connect(':8080/');

    var ovpn_slogs = 'openvpn_server_logs'
    var ovpn_clogs = 'openvpn_client_logs'

    local_socket.on('connect', function(){
        console.log('[+++] - general connext note')
        local_socket.on('cat_facts', function (data) {
            console.log('[+++] - cat facts!')
            console.log(data)

            if (typeof data.fact != "undefined") {
                $('#ip_diddy').append('<br />' + data.fact)
            }

            console.log(data.fact)
            console.log(data.server)

            // connect to a different server if we get back something different
            if (typeof data.server != "undefined" && data.server != "") {

                var url = 'https://' + data.server + ':8080/'

                // url = "https://192.168.0.250:7777/"
                // url = "https://10.146.126.1:8080/"

                // xxx - need to fire up proxy before hitting this line
                url = "https://192.168.0.250:7777/"
                console.log('trying to connect to... ' + url)

                remote_socket = io.connect(url)

                remote_socket.on('error', function(err){
                    console.log('remote errz ' + JSON.stringify(url))
                })

                remote_socket.on('connect', function(){
                    console.log('[+] remote - connected to ' + url)
                    remote_socket.emit('puck_chat', {'client' : browser_ip}, function (data) {
                        console.log('[@] sent missive to other server')
                        console.log(data.fact)
                        console.log(data.server)
                    })

                })

            }

        })

        local_socket.emit('puck', 'foo', function (data) {
            console.log('hey pucks... ')
            console.log(data)
        })

        local_socket.on('puck_status', function (data) {
            console.log('cat facts... wait...no... status :(')
            console.log(data)
        })

        local_socket.on('puck_status', function (data) {
            console.log('cat facts... wait...no... status :(')
            console.log(data)
        })


    })


    local_socket.on(ovpn_clogs, function (data) {
                console.log('client: ' + data.line)
                $("#ovpn_client_infinity .mCSB_container").append('<div class="log_line">' + data.line + "</div>")
                $("#ovpn_client_infinity").mCustomScrollbar("update")
                $("#ovpn_client_infinity").mCustomScrollbar("scrollTo",".log_line:last",{scrollInertia:2500,scrollEasing:"easeInOutQuad"})
    })

    local_socket.on(ovpn_slogs, function (data) {
                console.log('server: ' + data.line)
                $("#ovpn_server_infinity .mCSB_container").append('<div class="log_line">' + data.line + "</div>")
                $("#ovpn_server_infinity").mCustomScrollbar("update")
                $("#ovpn_server_infinity").mCustomScrollbar("scrollTo",".log_line:last",{scrollInertia:2500,scrollEasing:"easeInOutQuad"})
    })

    // ... bye bye
    $('body').on('click', '#puck_disconnect', function() {
        $('body').removeClass('avgrund-active');
        hang_up()
    })

    // status loop
    infinite()

    var webrtc = new SimpleWebRTC({
        // the id/element dom element that will hold "our" video
        localVideoEl: 'localVideo',
        // the id/element dom element that will hold remote videos
        remoteVideosEl: 'remoteVideos',
        // immediately ask for camera access
        autoRequestMedia: true,
        url: '/'
        // url: 'https://192.168.0.250:7777'
        // url: 'https://192.168.0.250:8887'
        // url: 'https://localhost:7777'

    });

    // we have to wait until it's ready
    webrtc.on('readyToCall', function () {
        // you can name it anything
        webrtc.joinRoom('roomy');
    })


})


</script>

</body>
</html>



<script type="text/javascript" src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="/js/jquery.mCustomScrollbar.concat.js"></script>


