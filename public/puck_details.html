<!DOCTYPE html>
<html lang="en">
  <head>

<meta charset="utf-8">
<title>Detailed PUCKasaurus</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="rawr!">

<!-- Le styles -->
<!-- <link href="/css/bootstrap.min.css" rel="stylesheet"> -->

<!-- made a one line change in this, noted at top -->
<link href="/css/bootstrap.css" rel="stylesheet">

<!-- for calls -->
<link href="/css/avgrund.css" rel="stylesheet">

<!-- trivial bits here -->
<link href="/css/puck.css" rel="stylesheet">

<!-- form to add files -->
<link href="/css/jquery.filer.css" rel="stylesheet">

<!-- a few more icons -->
<link href="/css/whhg.css" rel="stylesheet">

<!-- nav menus -->
<link href="/css/yamm.css" rel="stylesheet">

<!-- <link href="/css/bootstrap-responsive.css" rel="stylesheet"> -->

<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="/js/html5shiv.js"></script>
<![endif]-->

<!-- for pucks -->
<!-- http://cube3x.com/adipoli-jquery-image-hover-plugin/ -->
<!-- <link href="/css/adipoli.css" rel="stylesheet" type="text/css"/> -->


</head>

<body>

    <div class="container">

        <nav class="navbar navbar-default zenlarge" role="navigation">

            <ul class="nav nav-tabs navbar-nav navbar-left">

                <li class="active"><a href="#home" data-toggle="tab"><span id="puck_top_home" title="home" data-content="Click your heels three times..." class="glyphicon glyphicon-home"></span></a></li>

                <li> <a href="#puck_vpn" data-toggle="tab"><span id="puck_video" title="VPN" data-content="All the cool stuff - calls, chat, etc" class="glyphicon glyphicon-facetime-video"></span></a></li>

                </ul>

            <ul class="nav nav-tabs navbar-nav navbar-right">

                <li> <a href="#"><span class="green glyphicon icon-lightbulb-idea" id="puck_status"></span></a></li>

                <li> <a href="#"><span data-content="help, videos, etc. here..." class="glyphicon icon-question-sign" id="puck_help"></span></a></li>

                <li> <a href="#skull" data-toggle="tab"><span id="puck_top_skull" title="PANIC!" data-content="Aieee!  Ack!  No!  PANIC TIME!!!!!" class="glyphicon icon-skull"></span></a></li>


                <li> <a target="_blank" href="https://github.com/zenfish/PUCK"><span id="puck_git" title="github sources" data-content="Github, sources 'n' secretz here" class="glyphicon icon-github"></span></a></li>

            </ul>

        </nav>


        <div class="container-fluid">

            <!-- for incoming/outgoing calls -->

            <a href="#" id="incoming" class="button left"></a>
            <a href="#" id="outgoing" class="button left"></a>

        </div> <!-- end of form/top stuff -->


        <div class="container-fluid tab-content">

        <!-- pucks -->

            <div class="tab-pane fade in active" id="home"> </div>
    
            <!-- profile -->
            <div class="tab-pane fade" id="skull">
                <div class="row-fluid marketing" id="puck_panic_area">

                    <div class="muted">
                        <h3 style="clear:both">&iexcl;PANIC!</h3>
                    </div>

                    <div>
                        <p> Pushing these buttons is not for the faint of heart.
                        <ul>
                            <p> <li><strong>PANIC</strong> will crush your PUCK into uselessness.  Good if people are hammering at your door wanting its data or keys.  UI will no longer work.</li>
                            <p> <li><strong>Stop server</strong> stops the PUCK server dead.  UI will no longer work until restarted!</li>
                            <p> <li><strong>Restart server</strong> does just that - the PUCK server restarts.  UI will no longer work until it finishes restarting.</li>
                            <p> <li><strong>Stop VPN client</strong> kills any VPN clients

                        </ul>
                    </div>

                    <p>
                    <div>
                        <button id="puck_panic" type="button" class="btn btn-danger">PANIC</button>
                        <button id="stop_server" type="button" class="btn">Stop Server</button>
                        <button id="restart_server" type="button" class="btn btn-warning">Restart Server</button>
                        <button id="halt_vpn_client" type="button" class="btn btn-primary">Die VPN, Die!</button>
                    </div>
                </div>
            </div>


        <div class="container">

            <div class="panel-group" id="puck_accordion">

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#puck_accordion" href="#puck_base_details">PUCK details </a>
                    </h4>
                </div>
                <div id="puck_base_details" class="panel-collapse collapse in">
                    <div id="puck_basics" class="panel-body"> </div>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#puck_accordion" href="#puck_vpn_details">PUCK VPN details </a>
                    </h4>
                </div>
                <div id="puck_vpn_details" class="panel-collapse collapse">
                    <div id="puck_vpn_basics" class="panel-body"> </div>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#puck_accordion" href="#puck_vpn_client_details">PUCK VPN client details </a>
                    </h4>
                </div>
                <div id="puck_vpn_client_details" class="panel-collapse collapse">
                    <div id="puck_vpn_client_basics" class="panel-body"> </div>
                </div>
            </div>

        </div>

        <!-- make it so -->
        <form action='/form' method="POST">
        <fieldset>
            <div class="control-group">
                <span> <input style="display:none" id="puck_action" name="puck_action" value="DELETE" /> </span>
                <span> <input style="display:none" id="puckid_form" name="puckid" value="" /> </span>
                <div class="controls">
                <!-- this does some javascript fu below to post the data and redirect back to this page -->
                <button id="puck_button_delete" class="btn btn-large btn-danger" onclick="puck_delete()">DELETE w NO CONFIRM </button>
                </div>
            </div>
        </fieldset>
        </form>
        </div>

        <!-- spacer n feets below -->

        <div class="btn-toolbar"> <span></span></div>
        <div class="btn-toolbar"> <span class="spacer100"></span></div>

        <div class="footer" id="puck_footy">
            <p id='ip_diddy' class="text-muted credit">no electrons were harmed in the making of this footer</p>
        </div>


<script type="text/javascript" src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src='/js/jquery-ui.1.9.2.min.js'></script>
<script type="text/javascript" src='/js/bootstrap.js'></script>
<script type="text/javascript" src='/js/moustache.js'></script>
<script type="text/javascript" src='/js/jquery.adipoli.min.js'></script>
<script type="text/javascript" src='/js/jquery.json-2.4.min.js'></script>
<script type="text/javascript" src='/js/jquery.inputmask.js'></script>
<script type="text/javascript" src="/js/underscore-min.js"></script>

<script type="text/javascript" src='/js/spin.js'></script>
<script type="text/javascript" src='/js/jquery.blockUI.js'></script>
<script type="text/javascript" src='/js/jquery.avgrund.js'></script>
<script type="text/javascript" src="/js/jquery.bootstrap-growl.min.js"></script>
<script type="text/javascript" src="/js/bootstrap-paginator.js"></script>

<!-- put a sock in it -->
<script type="text/javascript" src="/socket.io/socket.io.js"></script>

<script type="text/javascript" src="/js/jquery.filer.js"></script>
<script type="text/javascript" src="/js/jquery.mCustomScrollbar.concat.js"></script>
<script type="text/javascript" src="/js/simplewebrtc.js"></script>

<!-- my stuff -->
<script type="text/javascript" src='/js/puck.js'></script>
<script type="text/javascript" src='/js/main_puck.js'></script>

    <!-- make the known pucks appear in the correct section -->
    <script type='text/javascript'>

       puckid = ""
       //
       // if they hit nuke puck... post data to server to make it happen
       // 
       // TODO - check if it worked :)
       function puck_delete() {

          $('#puck_button_delete').text("... nuking ...")

          var puckid = document.getElementById('puckid').textContent

          console.log('deleting ' + puckid)

          var    dead_puck    = {}
          dead_puck['puckid'] = puckid
          dead_puck['action'] = 'DELETE'

          var postify = $.ajax({
               type: "POST",
               // XXXX
               url: "https://localhost:8080/puck",
               dataType: "json",
               data: dead_puck
          })
              .done(function()   { console.log("success"); })
              .fail(function()   { console.log("error"); })
              .always(function() { console.log("finished"); });
       window.location = '/puck.html'
       }





       $(document).ready(function () {

         $('#puck_accordion').collapse({
            toggle: false
         })

         // perhaps look for a better way :)
         var query = location.search.substr(1);
         var data = query.split("&");

         for(var i=0; i<data.length; i++) {
            var item = data[i].split("=");
            if (item[0] = "puckid") {
               $('#puck_vpn').append(item[1])
               // global
               puckid = item[1]
               console.log("puckid: " + item[1])
            }
            else {
               error = 1
               $('#puck_id').append("Error - this page must be called with a puckid=valid-id")
               console.log('Error - this page must be called with a valid-id, like https://localhost/puck_details.html?puck=markus007')
            }
         }
         $('input[id=puckid_form]').val(puckid)

         // get more detailed data...
         $.getJSON('/puck/' + puckid, function(puckinfo) {

            console.log(puckinfo)

            print_puck(puckid, puckinfo, ['#puck_basics', '#puck_vpn_basics', '#puck_vpn_client_basics'])

         })

     })

    </script>

  </body>
</html>
